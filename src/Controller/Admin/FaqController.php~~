<?php

namespace App\Controller\Admin;
use App\Controller\AppController;
use Cake\Core\Configure; 
use Cake\Network\Exception\ForbiddenException;
use Cake\Network\Exception\NotFoundException;
use Cake\View\Exception\MissingTemplateException;
use Cake\ORM\TableRegistry;
use Cake\Auth\DefaultPasswordHasher;
use Cake\Datasource\ConnectionManager;

class FaqController extends AppController
{
	public function index(){ 
		$this->loadModel('Faq');	
		    $this->viewBuilder()->layout('admin');
		$faq = $this->Faq->find('all')->order(['Faq.id' => 'asc'])->toarray();
		$this->set('faq', $faq);
	}

	public function add()
{
      $this->viewBuilder()->layout('admin');
  $this->loadModel('Faq'); 
  $newpack = $this->Faq->newEntity();
  if ($this->request->is(['post', 'put'])) {     
    $savepack = $this->Faq->patchEntity($newpack, $this->request->data);
    $results=$this->Faq->save($savepack);
    if ($results){
      $this->Flash->success(__('Faq has been saved.'));
      return $this->redirect(['action' => 'index']);  
    }else{
      $this->Flash->error(__('Faq not saved.'));
      return $this->redirect(['action' => 'index']);  
    }
  }
}


public function edit($id)
{
      $this->viewBuilder()->layout('admin');
  $this->loadModel('Faq');

  $Faq = $this->Faq->get($id);
  $this->set('Faq',$Faq);
  if ($this->request->is(['post', 'put'])) {
    $savepack = $this->Faq->patchEntity($Faq, $this->request->data);
    $results=$this->Faq->save($savepack);
    if ($results){
      $this->Flash->success(__('Faq has been updated.'));
      return $this->redirect(['action' => 'index']);  
    }else{
      $this->Flash->error(__('Faq not Updated.'));
      return $this->redirect(['action' => 'index']);  
    }           
  }
}

public function status($id,$status){

	$this->loadModel('Faq');
	if(isset($id) && !empty($id)){
	  $product = $this->Faq->get($id);
	  $product->status = $status;
	  if ($this->Faq->save($product)) {
		if($status=='Y'){
		  $this->Flash->success(__('Faq status has been Activeted.'));
		}else{
		  $this->Flash->success(__('Faq status has been Deactiveted.'));
		}
		return $this->redirect(['action' => 'index']);  
	  }
	}
  }
  



	public function delete($id)
	{
	  $this->loadModel('Faq');
	  $catdelete = $this->Faq->get($id);
	
		if($catdelete){
		  $this->Faq->deleteAll(['Faq.id' => $id]); 
		  $this->Faq->delete($catdelete);
	
		  $this->Flash->success(__('Enquiry has been deleted successfully.'));
		  return $this->redirect(['action' => 'index']);
		}
	}

}